{# IMPORTANT: Read `instructions/architecture` before making changes. #}
{% extends "base.html" %}

{% block title %}{{ t('welcome.page_title') }}{% endblock %}

{% block content %}
<!-- Manager Icon in Top Right -->
<a href="{{ url_for('admin.dashboard') }}" class="manager-icon" title="{{ manager_app.name }}">
    ⚙️
</a>

<div class="welcome-page">
    <header class="welcome-header">
        <h1>{{ t('welcome.header_title') }}</h1>
        <p>{{ t('welcome.header_subtitle') }}</p>
    </header>
    
    <div class="apps-grid">
        <!-- Other Apps -->
        {% for app in apps %}
        <div class="app-card">
            {# Use the select route which handles nginx configuration and port mapping correctly #}
            <a href="{{ url_for('welcome.select_app', app_id=app.id) }}" class="app-link" target="_blank">
                {% if app.logo %}
                    {# Strip 'uploads/' prefix if present since route already includes it #}
                    {% set logo_filename = app.logo.replace('uploads/', '', 1) if app.logo.startswith('uploads/') else app.logo %}
                    <img src="{{ url_for('admin.uploaded_file', filename=logo_filename) }}" alt="{{ app.name }}" class="app-logo">
                {% else %}
                    <div class="app-logo-placeholder">{{ app.name[0].upper() }}</div>
                {% endif %}
                <h3>{{ app.name }}</h3>
            </a>
            <a href="{{ url_for('docs.index', app_id=app.id) }}" class="app-doc-link">{{ t('welcome.docs_link') }}</a>
        </div>
        {% endfor %}
        
        {% if not apps %}
        <div class="no-apps">
            <p>{{ t('welcome.no_apps_title') }}</p>
            <p>
                {{ t('welcome.no_apps_cta_prefix') }}
                <a href="{{ url_for('admin.dashboard') }}">{{ t('welcome.no_apps_cta_link') }}</a>
                {{ t('welcome.no_apps_cta_suffix') }}
            </p>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}

